# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание проекта

Этот проект представляет собой веб-приложение, предназначенное для просмотра и покупки товаров. 
Ниже вы найдете подробное описание основных функциональных возможностей.

## Основные возможности

Карточки товаров:
-  При запуске проекта отображаются карточки товаров.
-  Каждая карточка содержит логотип и корзину заказов.
-  Нажатие на изображение товара открывает попап с деталями товара.

Попап товара:
-  В попапе дублируются название, изображение, краткое описание и цена товара.
-  Попап можно закрыть, нажав на крестик или на пустое место вне попапа.
-  Возможность добавить товар в корзину, нажав кнопку "Купить".

Карточка товара:
-  Каждая карточка товара содержит категорию, название, цену и изображение товара.

Корзина заказов:
-  Открывается в виде попапа.
-  Содержит название товара, цену, кнопку удаления и общую сумму заказа.
-  Закрывается при нажатии на пустое место или крестик.
-  Кнопка "Оформить" переходит к оформлению заказа.

Оформление заказа:
-  Выбор способа оплаты: онлайн или при получении.
-  Указание адреса доставки и переход к следующему шагу.
-  Ввод номера телефона и email-почты.
-  Подтверждение заказа и отображение уведомления об успешном оформлении.


## Представление о коде

Проект организован по архитектурному шаблону MVP (Model-View-Presenter).
В этой архитектуре каждый компонент выполняет свою четко определенную роль, что улучшает поддерживаемость и читаемость кода.

### Структура MVP

1. **Модель (Model):**
Отвечает за работу с данными приложения.
  - Отвечает за работу с данными приложения.
  - Классы: `Api`, `ApiListResponse`, `ApiPostMethods`.

2. **Представление (View):**
Отображает данные пользователю.
  - Отвечает за отображение данных пользователю.
  - Классы: `ICard`, `IGallery`, `IPage`.

3. **Представитель (Presenter):**
Связывает Модель и Представление.
  - Осуществляет связь между Моделью и Представлением.
  - Классы: `EventEmitter`, `EventName`, `Subscriber`, `EmitterEvent`.
  - Файлы: `event.ts`.


## Базовый код

1. **Класс `PopupComponent`**

  Класс `PopupComponent` — это многократно используемый компонент, который можно применять для создания модальных всплывающих окон. Он обеспечивает единообразный внешний вид и поведение всплывающих окон во всём приложении.

  * Класс `PopupComponent` использует интерфейс `IEvents` для передачи событий. Это позволяет вам отслеживать события при открытии или закрытии всплывающего окна.
  * Класс `PopupComponent` использует метод `render()` для отображения всплывающего окна с указанными данными. Это позволяет вам легко обновлять содержимое всплывающего окна, не создавая заново весь компонент.

  **Свойства**

  * **`container`**: HTML-элемент, который будет содержать всплывающее окно.
  * **`events`**: объект `IEvents`, который будет использоваться для передачи событий при открытии или закрытии всплывающего окна.

  **Методы**

  * **`open()`**: открывает всплывающее окно.
  * **`close()`**: закрывает всплывающее окно.
  * **`render()`**: отображает всплывающее окно с указанными данными.

  **Пример**
  ```typescript
  import { PopupComponent, IEvents } from './popup';

  class MyPopupComponent extends PopupComponent {
    constructor(container: HTMLElement, events: IEvents) {
      super(container, events);

      // Добавить прослушиватель событий нажатия для кнопки закрытия
      this._closeBtn.addEventListener('click', this.close.bind(this));

      // Добавить прослушиватель событий нажатия для области содержимого
      this._content.addEventListener('click', (event) => {
        // Предотвратить распространение события на контейнер
        event.stopPropagation();
      });
    }

    // Установить содержимое всплывающего окна
    set content(value: HTMLElement) {
      this._content.replaceChildren(value);
    }
  }

  // Создать новый экземпляр компонента всплывающего окна
  const popup = new MyPopupComponent(document.getElementById('popup-container'), new EventEmitter());

  // Открыть всплывающее окно
  popup.open();

  // Закрыть всплывающее окно
  popup.close();
  ```

2. **Класс "EventEmitter" (Брокер событий):**

  **Брокер событий** — это класс, который позволяет объектам подписываться на определённые типы событий и получать уведомления о них. Он действует как посредник между объектами, которые производят и обрабатывают сообщения.

  * **`on(eventName, callback)`**: подписывается на определённый тип событий.
  * **`once(eventName, callback)`**: подписывается на определённый тип событий один раз.
  * **`off(eventName, callback)`**: отписывается от определённого типа событий.
  * **`emit(eventName, data)`**: отправляет событие определённого типа.
  * **`onAll(callback)`**: подписывается на все события.
  * **`offAll()`**: отписывается от всех событий.
  * **`trigger(eventName, context)`**: создаёт коллбек-триггер, который генерирует событие при вызове.

3. **Класс "Api" (Взаимодействие с серверным API):**

  **Класс API** — это класс который позволяет отправлять запросы к API.

  **Конструктор**

  ```
  constructor(baseUrl: string, options: RequestInit = {}) {
  ```

  **Аргументы**

  * `baseUrl` — базовый URL API.
  * `options` — опции запроса.

  **Методы**

  * `getUri(uri: string)` — отправляет GET-запрос к указанному URI.
  * `postUri(uri: string, data: object, method: ApiPostMethods = 'POST')` — отправляет POST-запрос к указанному URI.

  **Примечание**

  * Метод `postUri()` принимает третий аргумент `method`, который по умолчанию равен `'POST'`. Это означает, что вы можете использовать этот метод для отправки запросов POST, PUT и DELETE.
  * Метод `handleResponse()` обрабатывает ответ сервера и возвращает объект JSON. Если ответ сервера не является успешным, то он возвращает ошибку.

4. **Класс ProductAPI:**

  **ProductAPI** — это класс, который позволяет взаимодействовать с API продуктов.

  **Конструктор** 

  ```
  constructor(readonly cdn: string, baseUrl: string, options?: RequestInit) {
  ```
  **Аргументы**

  * `cdn` — URL CDN для изображений продуктов.
  * `baseUrl` — базовый URL API продуктов.
  * `options` — опции запроса.

  **Методы**

  * `getProductList()` — получает список всех продуктов.
  * `getProductItem(id: string)` — получает подробную информацию о продукте по его идентификатору.
  * `orderProduct(order: IOrder)` — размещает заказ на продукт.

  **Дополнительно**

  * Класс `ProductAPI` можно использовать для создания собственного интернет-магазина.
  * Класс `ProductAPI` можно использовать для интеграции с другими системами, например, с системой управления заказами.

**Интерфейсы**

**Интерфейсы** используются для описания типов данных в TypeScript. Они позволяют определить структуру данных и набор методов, которые могут быть вызваны для работы с этими данными.

**IPage**

Интерфейс `IPage` описывает страницу с каталогом продуктов. Он содержит следующие свойства:

* `counter: number`  — счетчик элементов.
* `catalogue: HTMLElement[]` — массив элементов каталога.
* `locked: boolean` — флаг, указывающий, заблокирована ли страница.

**IGallery**

Интерфейс `IGallery` описывает галерею продуктов. Он содержит следующее свойство:

* `items: IProd[]` — массив элементов галереи.

**ISuccess**

Интерфейс `ISuccess` описывает результат успешной операции. Он содержит следующее свойство:

* `total: number` — общее значение.

**IProd**

Интерфейс `IProd` описывает продукт. Он содержит следующие свойства:

* `description?: string` — описание продукта. (необязательно)
* `id: string` — идентификатор продукта.
* `image: string` — URL изображения продукта.
* `title: string` — заголовок продукта.
* `category: string` — категория продукта.
* `price: number | null` — цена продукта.

**IOrder**

Интерфейс `IOrder` описывает заказ. Он содержит следующие свойства:

* `total: number` — общая стоимость заказа.
* `items: string[]` — массив идентификаторов продуктов в заказе.
* `payment: string` — информация о способе оплаты.
* `address: string` — информация об адресе доставки.

**IOrderF**

`IOrderF `взаимодействует с другими интерфейсами через наследование. В данном случае, `IOrderF` расширяет два других интерфейса: `ContactsFormErrors` и `OrderFormErrors`. Это означает, что все свойства, объявленные в интерфейсах `ContactsFormErrors` и `OrderFormErrors`, также становятся доступными в `IOrderF`.

* `address?: string` — ошибка в поле адреса.
* `payment?: string` — ошибка в поле способа оплаты.
* `email?: string` — ошибка в поле адреса электронной почты.
* `phone?: string` — ошибка в поле номера телефона.

**IOrderResult**

Интерфейс `IOrderResult` описывает результат заказа. Он содержит следующие свойства:

* `id: string` — идентификатор заказа.
* `total: number` — общая стоимость заказа.

**IContactInfo**

Интерфейс `IContactInfo` описывает контактную информацию. Он содержит следующие свойства:

* `email: string` — адрес электронной почты.
* `phone: string` — номер телефона.

**IBasket**

Интерфейс `IBasket` описывает корзину. Он содержит следующие свойства:

* `items: HTMLElement[]` — массив продуктов в корзине.
* `total: number` — общая стоимость товаров в корзине.
* `selected: string[]` — массив идентификаторов выбранных товаров в корзине.

**OrderFormErrors**

Тип `OrderFormErrors` описывает ошибки в форме заказа. Он содержит следующие свойства:

* `address?: string` — ошибка в поле адреса.
* `payment?: string` — ошибка в поле способа оплаты.

**ContactsFormErrors**

Тип `ContactsFormErrors` описывает ошибки в форме контактов. Он содержит следующие свойства:

* `email?: string` — ошибка в поле адреса электронной почты.
* `phone?: string` — ошибка в поле номера телефона.

**IAct**

Интерфейс `IAct` описывает действие. Он содержит следующее свойство:

* `onClick (evt: MouseEvent) => void` — функция, которая вызывается при нажатии на элемент.

**IActS**

Интерфейс `IActS` описывает успешное действие. Он содержит следующее свойство:

* `onClick () => void` — функция, которая вызывается при успешном выполнении действия.

**IOrders**

Интерфейс `IOrders` представляет собой объединение свойств из нескольких интерфейсов, таких как `ContactsFormErrors`, `OrderFormErrors` и `IState`.

* `items: string[]` — массив идентификаторов товаров в заказе.
* `total: number` — общая стоимость заказа.

**IState**

Интерфейс `IState` описывает состояние приложения. Он содержит следующие свойства:

* `validation: boolean` — статус проверки.
* `errors: string[]` — массив сообщений об ошибках.

## Файл api.ts

Файл api.ts содержит определения типов и класс для взаимодействия с серверным API.

1. Типы данных
ApiListResponse<Type>
Тип данных, представляющий ответ от сервера в виде списка.

-  total (Число): Общее количество элементов в списке.
-  items (Массив типа Type): Список элементов.

ApiPostMethods
Тип данных, представляющий методы запросов для создания (POST), обновления (PUT) и удаления (DELETE) ресурсов на сервере.

2. Класс Api

Класс Api предоставляет методы для выполнения HTTP-запросов к серверу.
Конструктор
-  baseUrl (Строка): Базовый URL сервера.
-  options (Объект RequestInit): Дополнительные параметры запроса, такие как заголовки и другие настройки.

Методы
-  get(uri: string): Выполняет HTTP-запрос методом GET по указанному URI.
-  post(uri: string, data: object, method: ApiPostMethods = 'POST'): Выполняет HTTP-запрос методом POST или другим указанным методом, отправляя указанные данные.

Защищенный метод
-  handleResponse(response: Response): Promise<object>: Обрабатывает ответ от сервера, возвращая либо данные в случае успешного запроса, либо сообщение об ошибке.

## Файл event.ts

1. EventName
Тип данных, представляющий имя события. Может быть строкой или регулярным выражением.

2. Subscriber
Тип данных для обработчика события. Функция, которая принимает данные и выполняет определенные действия.

3. EmitterEvent
Тип данных, представляющий событие, отправляемое эмиттером.
-  eventName (Строка): Имя события.
-  data (Неопределенный): Данные события.